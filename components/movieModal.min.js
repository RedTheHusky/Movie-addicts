class movieModal{constructor(options={}){function uuidv4(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=='x'?r:(r&0x3|0x8);return v.toString(16)})}
this.objName="";this.root={id:'',dom:'',jquery:''};this.modal="";this.widgetId=-1;this.id=uuidv4();this.profile={mode:1,notification:0,eye:0,page:'',search:'',protocol:''};this.settings={nameLength_min:6,nameLength_max:36,passwordLength_min:6,passwordLength_max:36,classList:{invalid:"error-content"}};if(options.root){this.root.id=options.root;if(this.root.id){this.root.dom=document.getElementById(this.root.id);this.root.jquery=$('#'+this.root.id)}
if(options.addModal2Root){this.addModal2Root()}}
this.objName=this.constructor.name}
addModal2Root(options={}){if(options.root){this.root.id=options.root;if(this.root.id){this.root.dom=document.getElementById(this.root.id);this.root.jquery=$('#'+this.root.id)}}
this.modal=new Modal({root:this.root.id});let content=`<div class="modal-dialog"><form name=formAuth" action="">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Edit movie</h4>
      </div>
      <div class="modal-body">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger bt-close" data-dismiss="modal">Close</button>
		 <button type="button" class="btn btn-default bt-save">Save</button>
      </div>
    </div>

  </form></div>`;this.modal.content=content;this.modal.addModal2Root();let fields={Title:'',Year:'',Runtime:'',Genre:'',Director:'',Writer:'',Actors:'',Plot:'',Language:'',Country:'',Poster:'',imdbRating:''};let content_details="";for(var key in fields){if(key==="Title"||key==="Year"||key==="Runtime"||key==="Director"||key==="Writer"||key==="Plot"||key==="Language"||key==="Poster"||key==="imdbRating"){let value=fields[key];if(key==="Poster"){content_details+=`<div class='form-group submit-group'>
				<label style="display:block" for="${key}" label${key}>${key}:</label>
				<input id="new${key}" value="${value}" class="text-input form-control input${key}"></input>
				<input class='fileInput' type="file" accept=".jpg, .jpeg, .png, .gif">
				</div>`}else{content_details+=`<div class='form-group submit-group'>
				<label style="display:block" for="${key}" label${key}>${key}:</label>
				<input id="new${key}" value="${value}" class="text-input form-control input${key}"></input>
				</div>`}}}
this.modal.setElement([{selector:".modal-body",task:"inner",value:content_details}])}
addEvents(){if(this.modal.modal.dom.querySelector(".bt-save")){let me=this;this.modal.modal.dom.querySelector(".bt-save").addEventListener("click",function(){me.modal.hide();if(me.mode==="new"){me.movie=new Movie()}
me.modal.getElements("input").forEach(function(input,index){let id=input.id;let movieid=id.replace("new","");if(movieid!=""){modalElements.submit.movie[movieid]=input.value}});if(me.mode==="edit"){me.movie.editMovie().then(function(response){if(typeof doAfterSuccessfulMovieEdit!=="undefined"){try{doAfterSuccessfulMovieEdit({obj:me,response:response})}
catch(err){console.warn('error at function call:',err)}}},function(reject){console.error("Error updating movie");let error={mode:"error",title:"editing movie"};if(reject.responseJSON&&reject.responseJSON.message){error.message=reject.responseJSON.message}else if(reject.response){error.message=reject.response}else if(reject){error.message=reject}
if(typeof doAfterFailedMovieEdit!=="undefined"){try{doAfterFailedMovieEdit({obj:me,response:reject})}
catch(err){console.warn('error at function call:',err)}}})}else if(options.mode==="new"){}})}}
displayAdd(options={}){if(options.movie){console.warn("Please remove movie instant");return!1}
this.mode="new";displaySubmit(options)}
displayEdit(options={}){if(!options.movie){console.warn("Request movie instant");return!1}
this.mode="edit";this.movie=options.movie;this.displaySubmit(options)}
displaySubmit(options={}){let movie='';let response={Title:'',Year:'',Runtime:'',Genre:'',Director:'',Writer:'',Actors:'',Plot:'',Language:'',Country:'',Poster:'',imdbRating:''};for(var key in response){if(options&&options.response){response[key]=options.response[key]||""}}
for(var key in response){if(key==="Title"||key==="Year"||key==="Runtime"||key==="Director"||key==="Writer"||key==="Plot"||key==="Language"||key==="Poster"||key==="imdbRating"){this.modal.setElement([{selector:".input"+key,task:"attribute-add",name:"value",value:response[key]||""}])}}
this.modal.setElement([{selector:".modal-title",task:"inner",value:"Edit movie: "+response.Title||""},"show"])}}