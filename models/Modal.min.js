class Modal{constructor(options={}){if(!(typeof options==='object')){options={}};function uuidv4(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=='x'?r:(r&0x3|0x8);return v.toString(16)})}
this.root={id:'',dom:'',jquery:''};this.modal={id:'',dom:'',jquery:''};this.modal.id="modal_"+uuidv4();this.loaded={css:!0,js:!0};this.content=`<button type="button" id="${this.modal.id}_toggle" class="btn btn-primary" style="display:none" data-toggle="modal" data-target="#${this.modal.id}"></button>
		<div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title" >Modal Header</h4>
        </div>
        <div class="modal-body" >
          <p>Some text in the modal.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>`;if(options.root){this.root.id=options.root;if(this.root.id){this.root.dom=document.getElementById(this.root.id);this.root.jquery=$('#'+this.root.id)}
if(options.addModal2Root){this.addModal2Root(options.addModal2Root)}}
if(options.add2Head){this.add2Head(options.add2Head)}
if(options.loadMode&&(options.loadMode==="n"||options.loadMode===0)){this.loaded.css=!1;this.loaded.js=!1}
if(options.content){this.content=options.content}}
add2Head(options={}){if(!(typeof options==='object')){options={}};let loadMode='a';if(options.loadMode){loadMode=options.loadMode}
let me=this;if(options.loadMode&&(options.loadMode==="n"||options.loadMode===0)){this.loaded.css=!0;this.loaded.js=!0}else if(options.loadMode&&(options.loadMode==="h"||options.loadMode===4)){this.loaded.css=!1;this.loaded.js=!1}
if(loadMode==='a'||loadMode==='c'||loadMode===1||loadMode===3){var css=document.createElement("link");css.href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css";css.setAttribute("rel","stylesheet");document.head.appendChild(css);if(css.addEventListener){css.addEventListener('load',function(){me.loaded.css=!0;if(options.callback&&me.loaded.js){options.callback()}},!1)}}
if(loadMode==='a'||loadMode==='s'||loadMode===1||loadMode===2){var script=document.createElement("script");script.src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js";document.head.appendChild(script);if(script.addEventListener){script.addEventListener('load',function(){me.loaded.js=!0;if(options.callback&&me.loaded.css){options.callback()}},!1)}}}
addModal2Root(options={}){if(!(typeof options==='object')){options={}};if(options.root){this.root.id=options.root;if(this.root.id){this.root.dom=document.getElementById(this.root.id);this.root.jquery=$('#'+this.root.id)}}
if($('#'+this.modal.id)[0]){console.warn("already exists");return!1}
if(this.root.dom&&this.isElement(this.root.dom)){this.modal.dom=document.createElement("div");this.modal.dom.classList.add("modal");this.modal.dom.classList.add("fade");this.modal.dom.setAttribute("id",this.modal.id);this.modal.dom.setAttribute("role","dialog");this.modal.dom.innerHTML=this.content;this.root.dom.appendChild(this.modal.dom);this.modal.jquery=$('#'+this.modal.id)}else{console.warn('Dom element does not exists')}}
removeModal4Root(){if(this.modal.dom){this.modal.dom.innerHTML="";this.modal.dom.parentNode.removeChild(this.modal.dom);this.modal.dom="";this.modal.jquery=""}}
setElement(options=[]){if(!(typeof options==='object')){options=[]};if(!this.modal.dom){console.warn('No modal to select');return}
let me=this;options.forEach(function(option,index){if(option==="show"){me.show()}else if(option==="hide"){me.hide()}else if(option==="toggle"){me.toggle()}else if(!option.selector){console.warn('No selector for: ',index)}else if(!me.root.dom.querySelector(option.selector)){console.warn('No element for: ',index)}else{if(option.task==="inner"){me.modal.dom.querySelector(option.selector).innerHTML=option.value}else if(option.task==="attribute-add"){me.modal.dom.querySelector(option.selector).setAttribute(option.name,option.value)}else if(option.task==="attribute-remove"){me.modal.dom.querySelector(option.selector).removeAttribute(option.name)}else if(option.task==="class-add"){me.modal.dom.querySelector(option.selector).classList.add(option.value)}else if(option.task==="class-remove"){me.modal.dom.querySelector(option.selector).classList.remove(option.value)}else{console.warn('No task for: ',index)}}})}
checkifRead(option="a"){if(!(typeof option==='string')){option="a"};if((option==="a"||option==="c")&&!this.loaded.css){console.warn("stylesheet not loaded");return!1}
if((option==="a"||option==="s")&&!this.loaded.js){console.warn("script not loaded");return!1}
if((option==="a"||option==="r")&&(!this.root.dom||!this.isElement(this.root.dom))){console.warn("no root defined");return!1}
if(!($('#'+this.modal.id))){console.warn("no modal defined");return!1}
return!0}
toggle(option="toggle"){if(!(typeof option==='string')){option="toggle"};if(!this.checkifRead()){console.warn("not ready");return}
if(option!="toggle"&&option!="show"&&option!="hide"){console.warn("not a valid option");return}
if(this.modal.jquery&&this.modal.jquery.modal){this.modal.jquery.modal(option)}else{console.warn("No way to toggle it!")}}
show(){this.toggle('show')}
hide(){this.toggle('hide')}
isElement(o){var r=(typeof HTMLElement==="object"?o instanceof HTMLElement:o&&typeof o==="object"&&o!==null&&o.nodeType===1&&typeof o.nodeName==="string");return r}
getElements(selector=""){if(!(typeof selector==='string')){selector="toggle"};if(!this.modal.dom){console.warn("There is no master dom to do querySelectorAll!");return[]}
let elements=this.modal.dom.querySelectorAll(selector);return elements}}